{"filter":false,"title":"main.js","tooltip":"/main.js","undoManager":{"mark":3,"position":3,"stack":[[{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"insert","lines":["m"],"id":1},{"start":{"row":0,"column":1},"end":{"row":0,"column":2},"action":"insert","lines":["a"]},{"start":{"row":0,"column":2},"end":{"row":0,"column":3},"action":"insert","lines":["i"]}],[{"start":{"row":0,"column":2},"end":{"row":0,"column":3},"action":"remove","lines":["i"],"id":2},{"start":{"row":0,"column":1},"end":{"row":0,"column":2},"action":"remove","lines":["a"]},{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"remove","lines":["m"]}],[{"start":{"row":0,"column":0},"end":{"row":308,"column":0},"action":"insert","lines":["//Select element function","const SelectElement = function (element) {","    return document.querySelector(element);","};","","let menuToggler = SelectElement('.menu-toggle');","let body = SelectElement('body');","","menuToggler.addEventListener('click', function (){","    body.classList.toggle('open');","});","","//Scroll reveal","window.sr = ScrollReveal();","","sr.reveal('.animate-left', {","    origin: 'left',","    duration: 1000,","    distance: '25rem',","    delay: '300'","});","","sr.reveal('.animate-right', {","    origin: 'right',","    duration: 1000,","    distance: '25rem',","    delay: '600'","});","","sr.reveal('.animate-top', {","    origin: 'top',","    duration: 1000,","    distance: '25rem',","    delay: '600'","});","","sr.reveal('.animate-bottom', {","    origin: 'bottom',","    duration: 1000,","    distance: '25rem',","    delay: '600'","});","","","// Google maps functionality","var map, infoWindow, service, keyWord, bounds;","var userPosition;","var markers = [];","var currentInfoWindow;","","function initMap() {","  bounds = new google.maps.LatLngBounds();","  infoWindow = new google.maps.InfoWindow();","  currentInfoWindow = infoWindow;","  if (navigator.geolocation) {","    navigator.geolocation.getCurrentPosition(","      function (position) {","        var pos = {","          lat: position.coords.latitude,","          lng: position.coords.longitude,","        };","        map = new google.maps.Map(document.getElementById(\"map\"), {","          center: pos,","          zoom: 15,","        });","        bounds.extend(pos);","        ","        infoWindow.setPosition(pos);","        infoWindow.setContent(\"Location found.\");","        infoWindow.open(map);","        map.setCenter(pos);","       ","      },","      function () {","        handleLocationError(true, infoWindow);","      }","    );","  } else {","    // Browser doesn't support Geolocation","    handleLocationError(false, infoWindow);","  }","}","// Handle a geolocation error","function handleLocationError(browserHasGeolocation, infoWindow) {","  // Set default location to Cambridge, United Kingdom","  pos = { lat:51.509865, lng:-0.118092 };","  map = new google.maps.Map(document.getElementById(\"map\"), {","    center: pos,","    zoom: 15,","  });","","  // Display an InfoWindow at the map center","  infoWindow.setPosition(pos);","  infoWindow.setContent(","    browserHasGeolocation ? \"Geolocation permissions denied. Using default location.\"","      : \"Error: Your browser doesn't support geolocation.\"","  );","  infoWindow.open(map);","  currentInfoWindow = infoWindow;","}","//add event listener for the buttons for different options","","document.getElementById(\"club\").addEventListener(\"click\", Club);","document.getElementById(\"sport\").addEventListener(\"click\", Sport);","document.getElementById(\"restaurant\").addEventListener(\"click\", Restaurant);","   ","function Club() {"," option('Club')","}","function Sport() {","  option('Gym');","}","function Restaurant() {"," option('restaurant');","}","","function option(keyWord){"," let request = {","    bounds: map.getBounds(),","    keyword: keyWord,","  };","","  service = new google.maps.places.PlacesService(map);","  service.nearbySearch(request, nearbyCallback);","}","//adding markers for the options","function nearbyCallback(results, status) {","  if (status == google.maps.places.PlacesServiceStatus.OK) {","    createMarkers(results);","  }","}","function createMarkers(places) {","  removeMarkers();","  places.forEach((place) => {","    let marker = new google.maps.Marker({","      position: place.geometry.location,","      map: map,","      title: place.name,","      animation: google.maps.Animation.DROP,","    });","","    markers.push(marker);","    //showing the place details on demand","    google.maps.event.addListener(marker, \"click\", function () {","        let request = {","        placeId: place.place_id,","        fields: [","          \"name\",","          \"formatted_address\",","          \"geometry\",","          \"rating\",","          \"website\",","          \"photos\",","          \"reviews\",","        ],","      };","","      /* Only fetch the details of a place when the user clicks on a marker.*/","","      service.getDetails(request, function (placeResult, status) {","        showDetails(placeResult, marker, status);","      });","    });","    // Adjust the map bounds to include the location of this marker","    bounds.extend(place.geometry.location);","  });","  /* Once all the markers have been placed, adjust the bounds of the map to","   * show all the markers within the visible area. */","  map.fitBounds(bounds);","}","","// clear markers for a different cuisine","function removeMarkers() {","  for (var i = 0; i < markers.length; i++) {","    if (markers[i]) {","      markers[i].setMap(null);","    }","  }","  markers = [];","}","","// Builds an InfoWindow to display details above the marker","function showDetails(placeResult, marker, status) {","  if (status == google.maps.places.PlacesServiceStatus.OK) {","    let placeInfowindow = new google.maps.InfoWindow();","    placeInfowindow.setContent(","      \"<div><strong>\" +","        placeResult.name +","        \"</strong><br>\" +","        \"Rating: \" +","        placeResult.rating +","        \"</div>\"","    );","    placeInfowindow.open(marker.map, marker);","    currentInfoWindow.close();","    currentInfoWindow = placeInfowindow;","    showCard(placeResult);","  } else {","    console.log(\"showDetails failed: \" + status);","  }","}","//display option details on a card","function showCard(placeResult) {","  let infoCard = document.getElementById(\"optionInfo\");","  //if infoCard is open remove the open class.","  if (infoCard.classList.contains(\"open\")) {","    infoCard.classList.remove(\"open\");","  }","","  //clearing previous details","  while (infoCard.lastChild) {","    infoCard.removeChild(infoCard.lastChild);","  }","","  //Adding photo if there is one","  if (placeResult.photos) {","    let firstPhoto = placeResult.photos[0];","    photo = document.createElement(\"img\");","    photo.classList.add(\"card-img-top\");","    photo.src = firstPhoto.getUrl();","    infoCard.appendChild(photo);","  }","  //new div created for card body","  var newDiv = document.createElement(\"div\");","  newDiv.classList.add(\"card-body\");","  infoCard.appendChild(newDiv);","  let title = document.createElement(\"h5\");","  title.classList.add(\"card-title\");","  title.textContent = placeResult.name;","  newDiv.appendChild(title);","  //add rationg if there is one","  if (placeResult.rating != null) {","    let rating = document.createElement(\"p\");","    rating.classList.add(\"card-text\");","    rating.textContent = `Rating: ${placeResult.rating} \\u272e`;","    newDiv.appendChild(rating);","  }","  let address = document.createElement(\"p\");","  address.textContent = `Address: ${placeResult.formatted_address}`;","  newDiv.appendChild(address);","  if (placeResult.website) {","    let websiteBut = document.createElement('button');","    let websiteLink = document.createElement('a');","    let websiteUrl = document.createTextNode(placeResult.website);","    websiteLink.appendChild(websiteUrl);","    websiteLink.textContent= \"Go to the website\";","    websiteLink.href = placeResult.website;","    websiteLink.classList.add(\"websiteLink\");","    websiteBut.classList.add(\"btn\");","    websiteBut.appendChild(websiteLink);","    newDiv.appendChild(websiteBut);","    } ","  ","  //Getting first 5 reviews reviews if there is one","  if (placeResult.reviews && placeResult.reviews.length) {","    let reviewDiv = document.createElement(\"div\");","    //create a new div for reviews to added to card body","    newDiv.appendChild(reviewDiv);","    reviewDiv.classList.add(\"review\");","    var contentStr =","      +\"<li>Reviews:\" +","      (function (rs, fx) {","        var list = document.createElement(\"ul\");","        reviewDiv.appendChild(list);","        rs.forEach(function (r) {","          list.appendChild(fx(r));","        });","        return \"<ul>\" + list.innerHTML + \"</ul>\";","        return list;","      })(placeResult.reviews, function (r) {","        var item = document.createElement(\"li\");","","        review = item.appendChild(document.createElement(\"ul\"));","        props = {","          author_name: \"author\",","          rating: \"rating\",","          text: \"text\",","        };","        item.appendChild(document.createElement(\"h6\"));","        item.lastChild.appendChild(document.createElement(\"a\"));","        item.lastChild.lastChild.appendChild(","          document.createTextNode(r.author_name)","        );","        item.lastChild.appendChild(","          document.createTextNode(\"(\" + r.rating + \")\")","        );","        if (r.aspect && r.aspect.length) {","          item.appendChild(document.createElement(\"ul\"));","          r.aspect.forEach(function (a) {","            item.lastChild.appendChild(document.createElement(\"li\"));","            item.lastChild.lastChild.appendChild(","              document.createElement.TextNode(a.type + \":\" + a.rating)","            );","          });","        }","        item.appendChild(document.createElement(\"p\"));","        item.lastChild.appendChild(document.createTextNode(r.text));","        return item;","      }) +","      \"</li>\";","    contentStr = +\"</ul>\";","    infoWindow.setContent(contentStr);","    } else {","    var contentStr = \"<h5>No Result, status=\" + status + \"</h5>\";","  }","","  infoCard.classList.add(\"open\");","}",""],"id":3}],[{"start":{"row":107,"column":15},"end":{"row":107,"column":16},"action":"insert","lines":[";"],"id":4}]]},"ace":{"folds":[],"scrolltop":1198,"scrollleft":0,"selection":{"start":{"row":112,"column":23},"end":{"row":112,"column":23},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":78,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1594299550649,"hash":"2a261497a6be6f07adef3b56ad06c65ac4434b80"}